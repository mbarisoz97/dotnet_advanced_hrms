services:
  ehrms.mq:
    image: rabbitmq:management-alpine
    container_name: Ehrms.mq
    hostname: ehrms-mq
    ports:
        - 5672:5672
    volumes:
        - ./.container/queue/data/:/var/lib/rabbitmq 
        - ./.container/queue/log/:/var/log/rabbitmq
    environment:
        RABBITMQ_DEFAULT_USER: guest
        RABBITMQ_DEFAULT_PASS: guest

  ehrms.employeeinfo.api:
    image: ${DOCKER_REGISTRY-}ehrmsemployeeinfoapi
    build:
      context: .
      dockerfile: src/Services/Ehrms.EmployeeInfo.API/Dockerfile
    depends_on: 
        - ehrms.mq

  ehrms.projectmanagement.api:
    image: ${DOCKER_REGISTRY-}ehrmsprojectmanagementapi
    build:
      context: .
      dockerfile: src/Services/Ehrms.ProjectManagement.API/Dockerfile
    depends_on: 
        - ehrms.mq

  ehrms.trainingmanagement.api:
    image: ${DOCKER_REGISTRY-}ehrmstrainingmanagementapi
    build:
      context: .
      dockerfile: src/Services/Ehrms.TrainingManagement.API/Dockerfile
    depends_on: 
        - ehrms.mq